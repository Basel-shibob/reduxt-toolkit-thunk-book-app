{"ast":null,"code":"import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport { logInsert } from \"./reportSlice\";\nexport const getBooks = createAsyncThunk('book/getBook', async (_, thunkAPI) => {\n  const {\n    rejectWithValue\n  } = thunkAPI;\n\n  try {\n    const res = await fetch(\"http://localhost:3005/books\");\n    const data = await res.json();\n    return data;\n  } catch (error) {\n    return rejectWithValue(error.message);\n  }\n});\nexport const insertBook = createAsyncThunk('book/insertBook', async (bookData, thunkAPI) => {\n  const {\n    rejectWithValue,\n    getState,\n    dispatch\n  } = thunkAPI;\n\n  try {\n    bookData.userName = getState().auth.name;\n    const res = await fetch(\"http://localhost:3005/books\", {\n      method: 'POST',\n      body: JSON.stringify(bookData),\n      headers: {\n        'Content-type': 'application/json; charset=UTF-8'\n      }\n    });\n    const data = await res.json();\n    dispatch(logInsert({\n      name: 'insertBook',\n      status: 'success'\n    }));\n    return data;\n  } catch (error) {\n    dispatch(logInsert({\n      name: 'insertBook',\n      status: 'failed'\n    }));\n    return rejectWithValue(error.message);\n  }\n});\nexport const deletetBook = createAsyncThunk('book/deleteBook', async (item, thunkAPI) => {\n  const {\n    rejectWithValue\n  } = thunkAPI;\n\n  try {\n    await fetch(`http://localhost:3005/books/${item.id}`, {\n      method: 'DELETE',\n      headers: {\n        'Content-type': 'application/json; charset=UTF-8'\n      }\n    });\n    return item;\n  } catch (error) {\n    return rejectWithValue(error.message);\n  }\n});\nconst bookSlice = createSlice({\n  name: 'book',\n  initialState: {\n    books: [],\n    isLoading: false,\n    error: null\n  },\n  extraReducers: {\n    // getbooks\n    [getBooks.pending]: (state, action) => {\n      state.isLoading = true;\n      state.error = null;\n    },\n    [getBooks.fulfilled]: (state, action) => {\n      state.isLoading = false;\n      state.books = action.payload;\n    },\n    [getBooks.rejected]: (state, action) => {\n      state.isLoading = false;\n      state.error = action.payload;\n    },\n    // insertbook\n    [insertBook.pending]: (state, action) => {\n      state.isLoading = true;\n      state.error = null;\n    },\n    [insertBook.fulfilled]: (state, action) => {\n      state.isLoading = false;\n      state.books.push(action.payload);\n    },\n    [insertBook.rejected]: (state, action) => {\n      state.isLoading = false;\n      state.error = action.payload;\n    },\n    // deletebook\n    [deletetBook.pending]: (state, action) => {\n      state.isLoading = true;\n      state.error = null;\n    },\n    [deletetBook.fulfilled]: (state, action) => {\n      state.isLoading = false;\n      state.books = state.books.filter(el => el.id !== action.payload.id);\n    },\n    [deletetBook.rejected]: (state, action) => {\n      state.isLoading = false;\n      state.error = action.payload;\n    }\n  }\n});\nexport default bookSlice.reducer;","map":{"version":3,"sources":["/home/ahmed/Documents/Basel's-work web/REACT JS/reduxt-toolkit-thunk-book-app/React/src/store/bookSlice.js"],"names":["createSlice","createAsyncThunk","logInsert","getBooks","_","thunkAPI","rejectWithValue","res","fetch","data","json","error","message","insertBook","bookData","getState","dispatch","userName","auth","name","method","body","JSON","stringify","headers","status","deletetBook","item","id","bookSlice","initialState","books","isLoading","extraReducers","pending","state","action","fulfilled","payload","rejected","push","filter","el","reducer"],"mappings":"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","sourcesContent":["import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport { logInsert } from \"./reportSlice\"\n\nexport const getBooks = createAsyncThunk(\n    'book/getBook',    \n    async (_, thunkAPI) => {\n        const { rejectWithValue } = thunkAPI;\n        try {\n            const res = await fetch(\"http://localhost:3005/books\");\n            const data = await res.json();\n            return data\n        } catch (error) {\n            return rejectWithValue(error.message);\n        }\n    }\n);\n\nexport const insertBook = createAsyncThunk(\n    'book/insertBook',\n    async (bookData, thunkAPI) => {\n        const { rejectWithValue, getState, dispatch } = thunkAPI;\n        try {\n            bookData.userName = getState().auth.name;\n            const res = await fetch(\"http://localhost:3005/books\", {\n                method: 'POST',\n                body: JSON.stringify(bookData),\n                headers: { 'Content-type': 'application/json; charset=UTF-8', }\n            });\n            const data = await res.json();\n            dispatch(logInsert({ name: 'insertBook', status: 'success' }));\n            return data\n        } catch (error) {\n            dispatch(logInsert({ name: 'insertBook', status: 'failed' }));\n            return rejectWithValue(error.message);\n        }\n    }\n);\n\nexport const deletetBook = createAsyncThunk(\n    'book/deleteBook',\n    async (item, thunkAPI) => {\n        const { rejectWithValue } = thunkAPI;\n        try {\n            await fetch(`http://localhost:3005/books/${item.id}`, {\n                method: 'DELETE',\n                headers: { 'Content-type': 'application/json; charset=UTF-8', }\n            });\n            return item\n        } catch (error) {\n            return rejectWithValue(error.message);\n        }\n    }\n);\n\n\nconst bookSlice = createSlice({\n    name: 'book',\n\n    initialState: { books: [], isLoading: false, error: null },\n\n    extraReducers: {\n\n        // getbooks\n        [getBooks.pending]: (state, action) => {\n            state.isLoading = true;\n            state.error = null;\n        },\n        [getBooks.fulfilled]: (state, action) => {\n            state.isLoading = false;\n            state.books = action.payload;\n        },\n        [getBooks.rejected]: (state, action) => {\n            state.isLoading = false;\n            state.error = action.payload;\n        },\n\n        // insertbook\n        [insertBook.pending]: (state, action) => {\n            state.isLoading = true;\n            state.error = null;\n        },\n        [insertBook.fulfilled]: (state, action) => {\n            state.isLoading = false;\n            state.books.push(action.payload);\n        },\n        [insertBook.rejected]: (state, action) => {\n            state.isLoading = false;\n            state.error = action.payload;\n        },\n\n\n        // deletebook\n        [deletetBook.pending]: (state, action) => {\n            state.isLoading = true;\n            state.error = null;\n        },\n        [deletetBook.fulfilled]: (state, action) => {\n            state.isLoading = false;\n            state.books = state.books.filter((el) => el.id !== action.payload.id); \n        },\n        [deletetBook.rejected]: (state, action) => {\n            state.isLoading = false;\n            state.error = action.payload;\n        },\n    },\n})\n\nexport default bookSlice.reducer;\n"]},"metadata":{},"sourceType":"module"}